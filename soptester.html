<html>
<head>
<title>SOP Tester</title>
<script>
function debug_view(){
	if (document.getElementById("check-debug").checked === true){
		document.getElementById("testcase-iframe").style.display = 'block';
	}
}
</script>
</head>
<body>
<link rel="stylesheet" type="text/css" href="style.css" />
<iframe src="" id="testcase-iframe"></iframe>
<button id="btn-go">GO!</button>
<input type="checkbox" id="check-debug">DEBUG ON

<script>
document.querySelector('button').addEventListener('click', function(){
	debug_view();
	var testnodes = Array.prototype.slice.call(document.querySelectorAll('*[data-test]'));
	function next_test(){
		if (testnodes.length === 0){
			alert("Finished!");
		}
		var node = testnodes.shift();
		window.display_result = function(success, exception){
			if(success === true){
				node.className='true';
			}else {
				node.className='false';
				var exceptionCell = document.createElement('td');
				exceptionCell = exceptionCell.appendChild(document.createTextNode(exception));
				node.appendChild(exceptionCell);
			}
			next_test();
		}
		document.querySelector('iframe').src = node.dataset.test;
	};
	next_test();	
});

/*document.getElementById('btn-go').onclick = function(){
	var nodes = document.getElementsByClassName('testcase')
	for (var i = 0; i < nodes.length; i++) {
		document.getElementById('testcase-iframe').src = nodes[i].dataset.test;
	}
};*/
</script>
<!--HTML Output-->
<table border=1>
<tr>
	<th>Testcase</th>
	<th>Should work in:</th>
	<th>Exception:</th>
</tr>
<tr data-test="tests/checkPort.html">
	<td>Check Port</td>
	<td>Chrome, FF</td>
</tr>
<tr data-test="tests/scriptInheritOrigin.html">
	<td>Script inherits origin</td>
	<td>not known</td>
</tr>
<tr data-test="tests/cssInheritOrigin.html">
	<td>CSS inherits origin</td>
	<td>not known</td>
</tr>
</table>
</body>
</html>